#!/bin/bash

[ -n "$_LOCK" ] || _LOCK=x exec flock -n $0 $0 "$@"

url=$(sed -r 's#^(git+ssh|ssh|git)://(\w+@)?##' <<< "$1")
params="${@:2}"

scheme=$(grep -Po '^\w+://' <<< "$url")
if [[ "$scheme" != "http://"
   && "$scheme" != "https://"
   && "$scheme" != "ftp://"
   && "$scheme" != "file://"
   && "$scheme" != "" ]]; then
    notify "Unexpected scheme: '$scheme'"
    exit 1
fi

if [[ -e "${url}" ]]; then
    url="$(readlink -f "${url}")"
fi

browser="chromium"

if [[ "$url" ]]; then
    i3-msg "exec \"$browser \\\"$url\\\""
else
    i3-msg "exec $browser"
fi
